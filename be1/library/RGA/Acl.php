<?php

namespace RGA;

use \Zend_Acl_Role as Role;
use \Zend_Acl_Resource as Resource;

class Acl extends \Zend_Acl {

    const ROLE_ANONYMOUS = 'anonymous';
    const ROLE_REGISTERED = 'registered';
    const ROLE_ADMIN = 'admin';
    const ROLE_TMP = 'tmp';

    const ADMIN_INDEX = 'admin:index';
    const ADMIN_STATS = 'admin:stats';

    const API_INDEX = 'api:index';
    const API_I18N = 'api:i18n';
    const API_USER = 'api:user';
    const API_ME = 'api:me';
    const API_MENC = 'api:menc';
    const API_LOGIN_STATUS = 'api:login-status';
    const API_CONVERSATION = 'api:conversation';
    const API_MESSAGE = 'api:message';
    const API_AUTH = 'api:auth';
    const API_MENTOR = 'api:mentor';
    const API_MENTEE = 'api:mentee';
    const API_INVITE = 'api:invite';
    const API_FILE = 'api:file';
    const API_DIAGNOSTIC = 'api:diagnostic';
    const API_NOTIFICATION = 'api:notification';
    const API_ACTIVITY = 'api:activity';
    const API_ACTIVITY_LANDING = 'api:activity-landing-page';
    const API_ACTIVITY_RESULT = 'api:activity-result';
    const API_ACTIVITY_STAT = 'api:activity-stat';
    const API_ARCHETYPE = 'api:archetype';
    const API_TRACKING = 'api:tracking';
    const API_CACHE = 'api:cache';
    const API_DATE_FACTS = 'api:date-facts';
    const API_ERROR = 'api:error';
    const API_CAPTCHA = 'api:captcha';
    const API_EMAIL = 'api:email';
    const API_STORIES = 'api:stories';
    const API_USER_META = 'api:user-meta';
    const API_USER_FLAG = 'api:user-flag';
    const API_FEED = 'api:feed';
    const API_NEWSLETTER_SUBSCRIPTOR = 'api:newsletter-subscriptor';
    const API_SOLRAPI = 'api:solrapi';
    const API_EVENT_INVITE = 'api:event-invite';
    const API_EVENT = 'api:event';
    const API_EVENT_NOTIFICATION = 'api:event-notification';
    const API_THIRD_PARTY_DATA = 'api:third-party-data';
    const API_THIRD_PARTY_FILE = 'api:third-party-file';
    const API_PHOTO_CONTEST = 'api:photo-contest';
    const API_USER_PROFILE = 'api:user-profile';
    const API_CHALLENGE = 'api:challenge';
    const API_USER_CHALLENGE = 'api:user-challenge';
    const API_CHALLENGE_CATEGORY = 'api:challenge-category';
    const API_MARQUEE_PHOTO = 'api:marquee-photo';
    const API_MARKETING_LANDING = 'api:marketing-landing';
    const API_SHARES = 'api:shares';
    const API_INSTITUTE = 'api:institute';
    const API_GUIDEHUB = 'api:guidehub';
    const API_GUIDEHUB_RESOURSES = 'api:guidehub-resources';
    const API_WOF = 'api:wof';
    const API_QUIZ = 'api:quiz';
    const API_CONTACT_FORM = 'api:contact-form';
    const API_HOW_IT_WORKS = 'api:how-it-works';
    const API_HELLO = 'api:hello-world';
    const API_EVENT_NEW = 'api:event-new';
    const API_CALLING_CARDS = 'api:calling-cards';
    const API_SURVEY_CHALLENGE = 'api:survey-challenge';
    const API_ACTIVITY_V2 = 'api:activity-app';
    const API_APP_PROGRESS = 'api:app-progress';
    const API_FAILED_AUTH = 'api:failed-auth';
    const API_USER_FEEDBACK = 'api:user-feedback';
    const API_LIBRARY = 'api:library';
    const API_PURPOSE_STORE = 'api:purpose-store';
    const API_HELP = 'api:help';
    const API_TERMS_PRIVACY = 'api:terms-privacy';
    const API_RIGHT_NAVIGATION = 'api:right-navigation';
    const API_USER_PURPOSE_STATEMENT = 'api:user-purpose-statement';
    const API_WEBHOOK = 'api:webhook';
    const API_PURPOSE_STATEMENT = 'api:purpose-statement';
    const API_LIFEMAP_SUPERPOWER = 'api:lifemap-superpower';
    const API_CSRF = 'api:csrf';
    const API_CHALLENGE_JSON = 'api:challenge-json';
    const API_USER_MINUTES = 'api:user-minutes';
    const API_USER_NOTIFICATION = 'api:user-notification';
    const API_CHALLENGE_V4_VERSIONING = 'api:challenge-v4-versioning';
    const API_PSEUDO_AUTO_APPLY_SUBSCRIPTION_COUPON = 'api:pseudo-auto-apply-subscription-coupon';
    const API_SEARCH = 'api:search';
    const API_USER_BOOKING= 'api:user-booking';
    const API_NEWSLETTER_COI_RESEND = 'api:newsletter-coi-resend';
    const API_USER_CHAT_DETAILS = 'api:userchatdetails';
    const API_DRPHIL_PAYWALL = 'api:drphil-paywall';
    const API_DRPHIL_ACCESS = 'api:drphil-access';


    const APP_INDEX = 'app:index';
    const APP_ERROR = 'app:error';
    const APP_USER = 'app:user';
    const APP_ACCOUNT = 'app:account';
    const APP_CONVERSATIONS = 'app:conversations';
    const APP_SOUNDING_BOARD = 'app:sounding-board';
    const APP_EVENTS = 'app:events';
    const APP_STORIES = 'app:stories';
    const APP_TAGS = 'app:tags';
    const APP_HOW_IT_WORKS = 'app:how-it-works';
    const APP_THE_INSTITUTE = 'app:the-institute';
    const APP_WORK = 'app:work';
    const APP_EXPERTS = 'app:experts';
    const APP_BOOK = 'app:book';
    const APP_INSPIRATION = 'app:inspiration';
    const APP_FEEDBACK = 'app:feedback';
    const APP_CONTACT = 'app:contact';
    const APP_HELP = 'app:help';
    const APP_LIBRARY = 'app:library';
    const APP_LIFEMAPGO = 'app:lifemap-mlp';
    const APP_INVITE = 'app:invite';
    const APP_OAUTH = 'app:oauth';
    const APP_SITEMAP = 'app:sitemap';
    const APP_FEED = 'app:feed';
    const APP_TERMS_AND_PRIVACY = 'app:terms-and-privacy';
    const APP_JANE_PAULEY = 'app:janepauley';
    const APP_HP_REDESIGN = 'app:hp-redesign';
    const APP_CMS = 'app:cms';
    const APP_MARKETING = 'app:marketing';
    const APP_ACTIVITY_LANDING_PAGE = 'app:activity-landing-page';
    const APP_DASHBOARD = 'app:dashboard';
    const APP_ACTIVITIES = 'app:activities';
    const APP_PRESCRIPTION = 'app:prescription';
    const APP_TOOL_DETAILS = 'app:tool-details';
    const APP_PRESS_CENTER = 'app:press-center';
    const APP_LIFEMAP = 'app:lifemap';
    const APP_REAL_POSSIBILITIES = 'app:real-possibilities';
    const APP_ELEVATE_YOUR_WORK = 'app:elevate-your-work';
    const APP_GROW_YOUR_RELATIONSHIP = 'app:grow-your-relationship';
    const APP_IMPROVE_YOUR_WELL_BEING = 'app:improve-your-well-being';
    const APP_STYLE_GUIDE = 'app:style-guide';
    const APP_RESULTS = 'app:results';
    const APP_KAPLAN = 'app:kaplan';
    const APP_KONNEX= 'app:konnex';
    const APP_CHALLENGE= 'app:challenge';
    const APP_CHALLENGE_CATEGORY= 'app:challenge-category';
    const APP_CHALLENGE_STEPS = 'app:challenge-steps';
    const APP_RENEW= 'app:renew-year';
    const APP_PHOTO_CONTEST= 'app:photo-contest';
    const APP_USER_PROFILE = 'app:user-profile';
    const APP_ONBOARDING = 'app:onboarding';
    const APP_QUIZ = 'app:quiz';
    const APP_SIGNATURE = 'app:signature';
    const APP_PAGE = 'app:page';
    const APP_PAGE_AMP = 'app:page-amp';
    const APP_AMP_TEST = 'app:article-amp-test';
    const APP_CONTACT_FORM = 'app:contact-form';
    const APP_WHO_WE_ARE = 'app:who-we-are';
    const APP_WOF = 'app:wof';
    const APP_LIFE_YOU_WANT = 'app:lifeyouwant';
    const APP_GOGO = 'app:gogo';
    const APP_CHALLENGES_ALL = 'app:challenges';
    const APP_QUIZ_ACTIVITY = 'app:quiz-activity';
    const APP_ACTIVITY_V2 = 'app:activity-app';
    const APP_FAITH = 'app:faith';
    const APP_GENERAL_CAMPAIGN = 'app:general-campaign';
    const APP_GENERAL_CAMPAIGN_LANDING_PAGE = 'app:general-campaign-landing-page';
    const APP_QUIZ_ME = 'app:quiz-me';
    const APP_PASTORS = 'app:pastors';
    const APP_POSSIBLE = 'app:possible';
    const APP_AUDIOTEST = 'app:audiotest';
    const APP_SUPERPOWER = 'app:superpower-landing-page';
    const APP_REACT_PLAYGROUND = 'app:react-playground';
    const APP_COACH = 'app:coach';
    const APP_PURPOSE_STORE = 'app:purpose-store';
    const APP_VANITY_URL = 'app:vanity-url';
    const APP_DR_PHIL_WAITING_LIST = 'app:dr-phil-waiting-list';
    const APP_DRPHIL_GO = 'app:drphil-go';
    const APP_DRPHIL = 'app:challenge-v3';
    const APP_CHALLENGE_V4 = 'app:challenge-v4';
    const APP_SUBSCRIPTION_OFFER_PAGE = 'app:subscription-offer-page';
    const APP_DOCS = 'app:docs';
    const APP_NEW_HOMEPAGE = 'app:home';
    const APP_COACHING = 'app:coaching';
    const APP_SEARCH = 'app:search';
    const APP_ARTICLE = 'app:article';
    const APP_REGISTRATION_AND_PAYMENT = 'app:registration-and-payment';
    const APP_ECOMMERCERESET = 'app:ecommercereset';
    const APP_CONFIRMATION_PAGE = 'app:confirmation-page';
    const APP_USER_INFO = 'app:user-info';

    const DEV_INDEX = 'dev:index';
    const DEV_DOC = 'dev:doc';

    public function __construct() {

        // resources
        $this->_setupAdminResources();
        $this->_setupApiResources();
        $this->_setupAppResources();
        $this->_setupDevResources();

        // roles
        $this->_setupRoles();

        // permissions
        $this->deny();
        $this->_setupAdminPermissions();
        $this->_setupApiPermissions();
        $this->_setupAppPermissions();
        $this->_setupDevPermissions();

    }

    protected function _setupAdminResources() {
        $this->add(new Resource(self::ADMIN_INDEX));
        $this->add(new Resource(self::ADMIN_STATS));
    }

    protected function _setupApiResources() {
        $this->add(new Resource(self::API_INDEX));
        $this->add(new Resource(self::API_I18N));
        $this->add(new Resource(self::API_USER));
        $this->add(new Resource(self::API_ME));
        $this->add(new Resource(self::API_MENC));
        $this->add(new Resource(self::API_LOGIN_STATUS));
        $this->add(new Resource(self::API_CONVERSATION));
        $this->add(new Resource(self::API_MESSAGE));
        $this->add(new Resource(self::API_AUTH));
        $this->add(new Resource(self::API_MENTOR));
        $this->add(new Resource(self::API_MENTEE));
        $this->add(new Resource(self::API_INVITE));
        $this->add(new Resource(self::API_FILE));
        $this->add(new Resource(self::API_DIAGNOSTIC));
        $this->add(new Resource(self::API_NOTIFICATION));
        $this->add(new Resource(self::API_ACTIVITY));
        $this->add(new Resource(self::API_ACTIVITY_LANDING));
        $this->add(new Resource(self::API_ACTIVITY_RESULT));
        $this->add(new Resource(self::API_ACTIVITY_STAT));
        $this->add(new Resource(self::API_ARCHETYPE));
        $this->add(new Resource(self::API_TRACKING));
        $this->add(new Resource(self::API_CACHE));
        $this->add(new Resource(self::API_DATE_FACTS));
        $this->add(new Resource(self::API_ERROR));
        $this->add(new Resource(self::API_CAPTCHA));
        $this->add(new Resource(self::API_EMAIL));
        $this->add(new Resource(self::API_STORIES));
        $this->add(new Resource(self::API_USER_META));
        $this->add(new Resource(self::API_USER_FLAG));
        $this->add(new Resource(self::API_FEED));
        $this->add(new Resource(self::API_NEWSLETTER_SUBSCRIPTOR));
        $this->add(new Resource(self::API_SOLRAPI));
        $this->add(new Resource(self::API_EVENT_INVITE));
        $this->add(new Resource(self::API_EVENT));
        $this->add(new Resource(self::API_EVENT_NOTIFICATION));
        $this->add(new Resource(self::API_THIRD_PARTY_DATA));
        $this->add(new Resource(self::API_THIRD_PARTY_FILE));
        $this->add(new Resource(self::API_PHOTO_CONTEST));
        $this->add(new Resource(self::API_USER_PROFILE));
        $this->add(new Resource(self::API_CHALLENGE));
        $this->add(new Resource(self::API_USER_CHALLENGE));
        $this->add(new Resource(self::API_CHALLENGE_CATEGORY));
        $this->add(new Resource(self::API_MARQUEE_PHOTO));
        $this->add(new Resource(self::API_MARKETING_LANDING));
        $this->add(new Resource(self::API_SHARES));
        $this->add(new Resource(self::API_INSTITUTE));
        $this->add(new Resource(self::API_GUIDEHUB));
        $this->add(new Resource(self::API_GUIDEHUB_RESOURSES));
        $this->add(new Resource(self::API_WOF));
        $this->add(new Resource(self::API_QUIZ));
        $this->add(new Resource(self::API_CONTACT_FORM));
        $this->add(new Resource(self::API_HOW_IT_WORKS));
        $this->add(new Resource(self::API_HELLO));
        $this->add(new Resource(self::API_EVENT_NEW));
        $this->add(new Resource(self::API_CALLING_CARDS));
        $this->add(new Resource(self::API_SURVEY_CHALLENGE));
        $this->add(new Resource(self::API_ACTIVITY_V2));
        $this->add(new Resource(self::API_APP_PROGRESS));
        $this->add(new Resource(self::API_FAILED_AUTH));
        $this->add(new Resource(self::API_USER_FEEDBACK));
        $this->add(new Resource(self::API_LIBRARY));
        $this->add(new Resource(self::API_PURPOSE_STORE));
        $this->add(new Resource(self::API_HELP));
        $this->add(new Resource(self::API_TERMS_PRIVACY));
        $this->add(new Resource(self::API_RIGHT_NAVIGATION));
        $this->add(new Resource(self::API_PURPOSE_STATEMENT));
        $this->add(new Resource(self::API_USER_PURPOSE_STATEMENT));
        $this->add(new Resource(self::API_WEBHOOK));
        $this->add(new Resource(self::API_LIFEMAP_SUPERPOWER));
        $this->add(new Resource(self::API_CSRF));
        $this->add(new Resource(self::API_CHALLENGE_JSON));
        $this->add(new Resource(self::API_USER_MINUTES));
        $this->add(new Resource(self::API_USER_NOTIFICATION));
        $this->add(new Resource(self::API_CHALLENGE_V4_VERSIONING));
        $this->add(new Resource(self::API_SEARCH));
        $this->add(new Resource(self::API_PSEUDO_AUTO_APPLY_SUBSCRIPTION_COUPON));
        $this->add(new Resource(self::API_USER_BOOKING));
        $this->add(new Resource(self::API_NEWSLETTER_COI_RESEND));
        $this->add(new Resource(self::API_DRPHIL_PAYWALL));
        $this->add(new Resource(self::API_USER_CHAT_DETAILS));
        $this->add(new Resource(self::API_DRPHIL_ACCESS));
    }

    protected function _setupAppResources() {
        $this->add(new Resource(self::APP_INDEX));
        $this->add(new Resource(self::APP_ERROR));
        $this->add(new Resource(self::APP_USER));
        $this->add(new Resource(self::APP_ACCOUNT));
        $this->add(new Resource(self::APP_SOUNDING_BOARD));
        $this->add(new Resource(self::APP_EVENTS));
        $this->add(new Resource(self::APP_STORIES));
        $this->add(new Resource(self::APP_TAGS));
        $this->add(new Resource(self::APP_HOW_IT_WORKS));
        $this->add(new Resource(self::APP_THE_INSTITUTE));
        $this->add(new Resource(self::APP_WORK));
        $this->add(new Resource(self::APP_EXPERTS));
        $this->add(new Resource(self::APP_BOOK));
        $this->add(new Resource(self::APP_INSPIRATION));
        $this->add(new Resource(self::APP_FEEDBACK));
        $this->add(new Resource(self::APP_CONTACT));
        $this->add(new Resource(self::APP_HELP));
        $this->add(new Resource(self::APP_LIBRARY));
        $this->add(new Resource(self::APP_LIFEMAPGO));
        $this->add(new Resource(self::APP_INVITE));
        $this->add(new Resource(self::APP_OAUTH));
        $this->add(new Resource(self::APP_SITEMAP));
        $this->add(new Resource(self::APP_FEED));
        $this->add(new Resource(self::APP_TERMS_AND_PRIVACY));
        $this->add(new Resource(self::APP_JANE_PAULEY));
        $this->add(new Resource(self::APP_HP_REDESIGN));
        $this->add(new Resource(self::APP_CMS));
        $this->add(new Resource(self::APP_MARKETING));
        $this->add(new Resource(self::APP_ACTIVITY_LANDING_PAGE));
        $this->add(new Resource(self::APP_DASHBOARD));
        $this->add(new Resource(self::APP_PRESS_CENTER));
        $this->add(new Resource(self::APP_LIFEMAP));
        $this->add(new Resource(self::APP_REAL_POSSIBILITIES));
        $this->add(new Resource(self::APP_ELEVATE_YOUR_WORK));
        $this->add(new Resource(self::APP_GROW_YOUR_RELATIONSHIP));
        $this->add(new Resource(self::APP_IMPROVE_YOUR_WELL_BEING));
        $this->add(new Resource(self::APP_STYLE_GUIDE));
        $this->add(new Resource(self::APP_RESULTS));
        $this->add(new Resource(self::APP_KAPLAN));
        $this->add(new Resource(self::APP_KONNEX));
        $this->add(new Resource(self::APP_CHALLENGE));
        $this->add(new Resource(self::APP_CHALLENGE_CATEGORY));
        $this->add(new Resource(self::APP_CHALLENGE_STEPS));
        $this->add(new Resource(self::APP_RENEW));
        $this->add(new Resource(self::APP_PHOTO_CONTEST));
        $this->add(new Resource(self::APP_USER_PROFILE));
        $this->add(new Resource(self::APP_ONBOARDING));
        $this->add(new Resource(self::APP_QUIZ));
        $this->add(new Resource(self::APP_SIGNATURE));
        $this->add(new Resource(self::APP_PAGE));
        $this->add(new Resource(self::APP_PAGE_AMP));
        $this->add(new Resource(self::APP_AMP_TEST));
        $this->add(new Resource(self::APP_CONTACT_FORM));
        $this->add(new Resource(self::APP_WHO_WE_ARE));
        $this->add(new Resource(self::APP_WOF));
        $this->add(new Resource(self::APP_LIFE_YOU_WANT));
        $this->add(new Resource(self::APP_GOGO));
        $this->add(new Resource(self::APP_CHALLENGES_ALL));
        $this->add(new Resource(self::APP_QUIZ_ACTIVITY));
        $this->add(new Resource(self::APP_ACTIVITY_V2));
        $this->add(new Resource(self::APP_FAITH));
        $this->add(new Resource(self::APP_QUIZ_ME));
        $this->add(new Resource(self::APP_GENERAL_CAMPAIGN));
        $this->add(new Resource(self::APP_GENERAL_CAMPAIGN_LANDING_PAGE));
        $this->add(new Resource(self::APP_PASTORS));
        $this->add(new Resource(self::APP_POSSIBLE));
        $this->add(new Resource(self::APP_AUDIOTEST));
        $this->add(new Resource(self::APP_SUPERPOWER));
        $this->add(new Resource(self::APP_REACT_PLAYGROUND));
        $this->add(new Resource(self::APP_COACH));
        $this->add(new Resource(self::APP_PURPOSE_STORE));
        $this->add(new Resource(self::APP_VANITY_URL));
        $this->add(new Resource(self::APP_DR_PHIL_WAITING_LIST));
        $this->add(new Resource(self::APP_DRPHIL_GO));
        $this->add(new Resource(self::APP_DRPHIL));
        $this->add(new Resource(self::APP_CHALLENGE_V4));
        $this->add(new Resource(self::APP_SUBSCRIPTION_OFFER_PAGE));
        $this->add(new Resource(self::APP_DOCS));
        $this->add(new Resource(self::APP_NEW_HOMEPAGE));
        $this->add(new Resource(self::APP_COACHING));
        $this->add(new Resource(self::APP_ARTICLE));

        $this->add(new Resource(self::APP_SEARCH));
        $this->add(new Resource(self::APP_REGISTRATION_AND_PAYMENT));
        $this->add(new Resource(self::APP_ECOMMERCERESET));
        $this->add(new Resource(self::APP_CONFIRMATION_PAGE));
        $this->add(new Resource(self::APP_USER_INFO));
    }

    protected function _setupDevResources() {
        $this->add(new Resource(self::DEV_INDEX));
        $this->add(new Resource(self::DEV_DOC));
    }

    protected function _setupRoles() {
        $this->addRole(new Role(self::ROLE_ANONYMOUS));
        $this->addRole(new Role(self::ROLE_TMP), self::ROLE_ANONYMOUS);
        $this->addRole(new Role(self::ROLE_REGISTERED), self::ROLE_ANONYMOUS);
        $this->addRole(new Role(self::ROLE_ADMIN), self::ROLE_REGISTERED);
    }

    protected function _setupAdminPermissions() {
        $this->allow(self::ROLE_ADMIN, self::ADMIN_INDEX, array('index'));
        $this->allow(self::ROLE_ADMIN, self::ADMIN_STATS, array('index'));
    }

    protected function _setupApiPermissions() {
        $this->allow(self::ROLE_ANONYMOUS, self::API_INDEX, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_I18N, array('index', 'get'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_USER, array('index', 'get', 'post'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_LOGIN_STATUS, array('index', 'get','post','put'));
        $this->allow(self::ROLE_REGISTERED, self::API_ME, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_MENC, array('index', 'get'));
        $this->allow(self::ROLE_REGISTERED, self::API_CONVERSATION, array('index', 'get', 'post'));
        $this->allow(self::ROLE_REGISTERED, self::API_MESSAGE, array('index', 'get', 'post'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_AUTH, array('index', 'get', 'post'));
        $this->allow(self::ROLE_REGISTERED, self::API_MENTOR, array('index', 'get', 'post'));
        $this->allow(self::ROLE_REGISTERED, self::API_MENTEE, array('index', 'get'));
        $this->allow(self::ROLE_REGISTERED, self::API_INVITE, array('index', 'get','post'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_INVITE, array('put'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_FILE, array('index', 'get'));
        $this->allow(self::ROLE_REGISTERED, self::API_FILE, array('index', 'get','post','put'));
        $this->allow(self::ROLE_TMP, self::API_DIAGNOSTIC, array('index', 'get','post','put','delete', 'patch'));
        $this->allow(self::ROLE_REGISTERED, self::API_DIAGNOSTIC, array('index', 'get','post','put','delete', 'patch'));
        $this->allow(self::ROLE_REGISTERED, self::API_NOTIFICATION, array('index', 'get','post','put'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_ACTIVITY, array('index', 'get'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_ACTIVITY_LANDING, array('index', 'get'));
        $this->allow(self::ROLE_REGISTERED, self::API_ACTIVITY_RESULT, array('index', 'get','post','put'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_ACTIVITY_RESULT, array('get'));
        $this->allow(self::ROLE_REGISTERED, self::API_ACTIVITY_STAT, array('index', 'get'));
        $this->allow(self::ROLE_TMP, self::API_ACTIVITY_STAT, array('index', 'get'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_ACTIVITY_STAT, array('get'));
        $this->allow(self::ROLE_REGISTERED, self::API_ARCHETYPE, array('index', 'get'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_TRACKING, array('index', 'get'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_CACHE, array('index', 'delete'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_DATE_FACTS, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_ERROR, array('index', 'error'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_CAPTCHA, array('index', 'get', 'post'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_EMAIL, array('post'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_STORIES, array('index', 'get'));
        $this->allow(self::ROLE_REGISTERED, self::API_USER_META, array('post','put'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_USER_META, array('index', 'get'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_FEED, array('index'));
        $this->allow(self::ROLE_REGISTERED, self::API_USER_FLAG, array('post', 'put', 'delete'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_USER_FLAG, array('get'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_NEWSLETTER_SUBSCRIPTOR, array('index', 'get', 'post', 'put'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_SOLRAPI, array('index', 'get'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_EVENT_INVITE, array('index', 'get', 'post', 'put'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_EVENT, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_EVENT_NOTIFICATION, array('index', 'delete'));
        $this->allow(self::ROLE_REGISTERED, self::API_THIRD_PARTY_DATA, array('index', 'get', 'post','put','delete'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_THIRD_PARTY_FILE, array('index', 'get'));
        $this->allow(self::ROLE_REGISTERED, self::API_PHOTO_CONTEST, array('index', 'get', 'post','put','delete'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_CHALLENGE, array('index', 'get'));
        $this->allow(self::ROLE_REGISTERED, self::API_USER_CHALLENGE, array('index', 'get', 'post', 'put'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_CHALLENGE_CATEGORY, array('index', 'get'));
        $this->allow(self::ROLE_REGISTERED, self::API_USER_PROFILE, array('index', 'get', 'put'));
        $this->allow(self::ROLE_REGISTERED, self::API_MARQUEE_PHOTO, array('index','get','put'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_MARKETING_LANDING, array('index','get','post'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_SHARES, array('index','get','post'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_INSTITUTE, array('index','get'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_GUIDEHUB, array('index','get'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_GUIDEHUB_RESOURSES, array('index','get'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_WOF, array('index','get'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_QUIZ, array('index','get', 'post'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_CONTACT_FORM, array('index','get', 'post'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_HOW_IT_WORKS, array('index','get'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_HELLO, array('index','get'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_EVENT_NEW, array('index','get'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_CALLING_CARDS, array('index','get', 'post', 'put'));
        $this->allow(self::ROLE_REGISTERED, self::API_SURVEY_CHALLENGE, array('post','get'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_ACTIVITY_V2, array('post','get'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_APP_PROGRESS, array('post','get'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_FAILED_AUTH, array('index'));
        $this->allow(self::ROLE_REGISTERED, self::API_USER_FEEDBACK, array('post'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_LIBRARY, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_PURPOSE_STORE, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_HELP, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_TERMS_PRIVACY, array('index'));
        $this->allow(self::ROLE_REGISTERED, self::API_RIGHT_NAVIGATION, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_PURPOSE_STATEMENT, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_USER_PURPOSE_STATEMENT, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_WEBHOOK, array('post'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_LIFEMAP_SUPERPOWER, array('get','post'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_CSRF, array('post', 'index'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_CHALLENGE_JSON, array('get','post','index'));
        $this->allow(self::ROLE_REGISTERED, self::API_USER_MINUTES, array('get', 'index'));
        $this->allow(self::ROLE_REGISTERED, self::API_USER_NOTIFICATION, array('post'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_CHALLENGE_V4_VERSIONING, array('post', 'get', 'index'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_SEARCH, array('index', 'get'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_PSEUDO_AUTO_APPLY_SUBSCRIPTION_COUPON, array('post'));
        $this->allow(self::ROLE_REGISTERED, self::API_USER_BOOKING, array('put'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_NEWSLETTER_COI_RESEND, array('post'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_DRPHIL_PAYWALL, array('post'));
        $this->allow(self::ROLE_ANONYMOUS, self::API_USER_CHAT_DETAILS, array('index'));
        $this->allow(self::ROLE_REGISTERED, self::API_DRPHIL_ACCESS, array('post'));
    }

    protected function _setupAppPermissions() {
        $this->allow(self::ROLE_ANONYMOUS, self::APP_INDEX, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_ERROR, array('error'));
        $this->allow(self::ROLE_REGISTERED, self::APP_USER, array('settings', 'logout', 'cancel'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_USER, array('index', 'sign-up', 'social-sign-up', 'logout', 'cancel'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_USER, array('login','external', 'link-accounts', 'login-token'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_ACCOUNT, array('index', 'change-password', 'email-unsubscribe', 'forgot-password'));
        $this->allow(self::ROLE_REGISTERED, self::APP_SOUNDING_BOARD, array('index', 'activity', 'activity-result', 'activity-widget'));
//        todo manage list for events to map recent implementation
        $this->allow(self::ROLE_ANONYMOUS, self::APP_EVENTS, array('index','upcoming','past','nearby', "invite", "detail","show-more-events"));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_STORIES, array('index', 'theme', 'details', 'all', 'rss', 'category', 'shares'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_TAGS, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_HOW_IT_WORKS, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_THE_INSTITUTE, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_WORK, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_EXPERTS, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_BOOK, array('index', 'buy', 'bonus-content'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_INSPIRATION, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_FEEDBACK, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_CONTACT, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_HELP, array('index','search','contact'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_LIBRARY, array('index', 'search'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_LIFEMAPGO, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_INVITE, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_OAUTH, array('request-token', 'access-token', 'authorize'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_SITEMAP, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_FEED, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_TERMS_AND_PRIVACY, array('index', 'search', 'slug'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_JANE_PAULEY, array('index', 'theme', 'details', 'rss'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_HP_REDESIGN, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_CMS, array('preview'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_MARKETING, array('page', 'index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_ACTIVITY_LANDING_PAGE, array('index','page'));
        $this->allow(self::ROLE_REGISTERED, self::APP_DASHBOARD, array('index', 'feed', 'activities', 'conversations', 'how-to', 'activity-results', 'start-check-up', 'check-up'));
        $this->allow(self::ROLE_TMP, self::APP_DASHBOARD, array('start-check-up', 'check-up', 'activity', 'start-activity'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_DASHBOARD, array('start-check-up', 'start-activity'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_DASHBOARD, array('activity-temp'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_PRESS_CENTER, array('index','press-release','news-listing', 'press-listing'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_LIFEMAP, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_REAL_POSSIBILITIES, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_ELEVATE_YOUR_WORK, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_GROW_YOUR_RELATIONSHIP, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_IMPROVE_YOUR_WELL_BEING, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_STYLE_GUIDE, array('index','brand','structure','interactive'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_RESULTS, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_KAPLAN, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_KONNEX, array('confirm'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_CHALLENGE, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_CHALLENGE_CATEGORY, array('index'));
        $this->allow(self::ROLE_REGISTERED, self::APP_CHALLENGE_STEPS, array('index', 'journal'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_RENEW, array('index', 'details'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_PHOTO_CONTEST, array('index'));
        $this->allow(self::ROLE_REGISTERED, self::APP_USER_PROFILE, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_USER_PROFILE, array('expert'));
        $this->allow(self::ROLE_REGISTERED, self::APP_ONBOARDING, array('index', 'skip'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_QUIZ, array('index', 'app'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_CONTACT_FORM, array('index','api'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_SIGNATURE, array('index','api'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_PAGE, array('index','api'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_PAGE_AMP, array('index','api'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_AMP_TEST, array('index', 'api'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_WHO_WE_ARE, array('index','api'));
        $this->allow(self::ROLE_REGISTERED, self::APP_WOF, array('index, wof'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_LIFE_YOU_WANT, array('index', "ca", "wa","quiz", "result","goodlife"));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_GOGO, array('index','api'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_CHALLENGES_ALL, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_QUIZ_ACTIVITY, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_ACTIVITY_V2, array('index', 'handle-gifts'));
        $this->allow(self::ROLE_REGISTERED, self::APP_QUIZ_ACTIVITY, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_FAITH, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_QUIZ_ME, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_GENERAL_CAMPAIGN, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_GENERAL_CAMPAIGN_LANDING_PAGE, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_PASTORS, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_POSSIBLE, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_AUDIOTEST, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_SUPERPOWER, array('index','superpower'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_REACT_PLAYGROUND, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_COACH, array('index', 'profile'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_PURPOSE_STORE, array('index', 'search'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_VANITY_URL, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_DR_PHIL_WAITING_LIST, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_DRPHIL_GO, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_DRPHIL, array('index','challenge','activity','journal','gold-dashboard'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_CHALLENGE_V4, array('index'));
        $this->allow(self::ROLE_REGISTERED, self::APP_SUBSCRIPTION_OFFER_PAGE, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_DOCS, array('index', 'display'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_NEW_HOMEPAGE, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_COACHING, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_SEARCH, array('index', 'search'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_ARTICLE, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_REGISTRATION_AND_PAYMENT, array('index','register','register-confirm'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_ECOMMERCERESET, array('index','confirmation-page','lifemap-suspend-subscription','suspend-access'));
        $this->allow(self::ROLE_ANONYMOUS, self::APP_CONFIRMATION_PAGE, array('index','secure-return'));
        $this->allow(self::ROLE_REGISTERED, self::APP_USER_INFO, array('index'));
    }

    protected function _setupDevPermissions() {
        $this->allow(self::ROLE_ANONYMOUS, self::DEV_INDEX, array('index'));
        $this->allow(self::ROLE_ANONYMOUS, self::DEV_DOC, array('index', 'api', 'coding-guideline', 'styleguide', 'js-api'));
    }
}
